<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>countcheck • countcheck</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="countcheck">
<meta property="og:description" content="countcheck">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">countcheck</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/countcheck.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jmeydam/countcheck/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="countcheck_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>countcheck</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/jmeydam/countcheck/blob/master/vignettes/countcheck.Rmd"><code>vignettes/countcheck.Rmd</code></a></small>
      <div class="hidden name"><code>countcheck.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jmeydam/countcheck">countcheck</a></span><span class="op">)</span></code></pre></div>
<div id="detecting-count-anomalies-using-bayesian-hierarchical-models" class="section level2">
<h2 class="hasAnchor">
<a href="#detecting-count-anomalies-using-bayesian-hierarchical-models" class="anchor"></a>Detecting Count Anomalies Using Bayesian Hierarchical Models</h2>
<p>Prototype (R package).</p>
<ul>
<li>Dertermines upper control limits for count data</li>
<li>Reasonable results also in cases with few or no observed events</li>
<li>HTML reports</li>
</ul>
<p>Model and code are based on examples in <a href="https://www.stat.columbia.edu/~gelman/book/">Gelman et al. (2014)</a> and <a href="https://xcelab.net/rm/statistical-rethinking/">McElreath (2020)</a>.</p>
<p>This prototype is related to a previous <a href="https://jmeydam.github.io/count-anomalies/simulation_study.html">simulation study</a>.</p>
<p>The distributions and parameters in the simulation study were chosen so that the generated data is comparable to certain data of interest. The prototype is meant to be used for roughly the same kind of data. Please refer to this <a href="https://jmeydam.github.io/count-anomalies/simulation_study.html">report</a> for details.</p>
<p>The package documentation can be accessed via the <a href="https://jmeydam.github.io/countcheck/">package website</a>.</p>
</div>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>First install dependencies.</p>
<p>To get a working C++ toolchain on macOS Big Sur (version 11.2.1 or higher), install Xcode from the App Store or install Xcode command line tools in a shell:</p>
<pre><code>% xcode-select --install</code></pre>
<p>Follow the instructions for cmdstanr. The macOS <a href="https://github.com/rmacoslib/r-macos-rtools">R toolchain installer</a> referred to in the <a href="https://github.com/stan-dev/rstan/wiki/RStan-Getting-Started">RStan documentation</a> is then not needed.</p>
<p>Next, install the following R packages and their dependencies in this order:</p>
<ul>
<li>actuar</li>
<li>extraDistr</li>
<li>knitr</li>
<li>cmdstanr (<a href="https://mc-stan.org/cmdstanr/articles/cmdstanr.html">instructions</a>, also for installing CmdStan)</li>
<li>rstan (<a href="https://github.com/stan-dev/rstan/wiki/RStan-Getting-Started">instructions</a> - on macOS skip section on toolchain)</li>
<li>rethinking (&gt;= 2.13)</li>
</ul>
<p>The rethinking package needs to be installed from <a href="https://github.com/rmcelreath/rethinking">GitHub</a>.</p>
<p>The prototype can then be installed from GitHub with:</p>
<pre><code><a href="https://devtools.r-lib.org//reference/remote-reexports.html">devtools::install_github("https://github.com/jmeydam/countcheck.git", 
                         build_vignettes = FALSE)</a></code></pre>
</div>
<div id="example" class="section level2">
<h2 class="hasAnchor">
<a href="#example" class="anchor"></a>Example</h2>
<p>We simulate count data for 1000 observational units, assuming a certain known data-generating process.</p>
<p>The data-generating process is free of anomalies, and all counts exceeding their respective upper control limits (UCLs) are false positives. Other things being equal it is desirable to have as few false positives as possible.</p>
<p>When we compare the results for the partial-pooling and complete pooling models we tend to find that using a Bayesian hierarchical model with partial pooling far fewer new counts exceed their respective upper control limits.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/countcheck.html">countcheck</a></span><span class="op">(</span>random_seed <span class="op">=</span> <span class="fl">200807</span><span class="op">)</span>
<span class="co">#&gt; This is cmdstanr version 0.3.0</span>
<span class="co">#&gt; - Online documentation and vignettes at mc-stan.org/cmdstanr</span>
<span class="co">#&gt; - CmdStan path set to: /Users/jens/.cmdstanr/cmdstan-2.26.0</span>
<span class="co">#&gt; - Use set_cmdstan_path() to change the path</span>
<span class="co">#&gt; Compiling Stan program...</span>
<span class="co">#&gt; Running MCMC with 4 sequential chains, with 1 thread(s) per chain...</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Chain 1 Iteration:    1 / 4000 [  0%]  (Warmup) </span>
<span class="co">#&gt; Chain 1 Iteration:  100 / 4000 [  2%]  (Warmup) </span>
<span class="co">#&gt; Chain 1 Iteration:  200 / 4000 [  5%]  (Warmup) </span>
<span class="co">#&gt; Chain 1 Iteration:  300 / 4000 [  7%]  (Warmup) </span>
<span class="co">#&gt; Chain 1 Iteration:  400 / 4000 [ 10%]  (Warmup) </span>
<span class="co">#&gt; Chain 1 Iteration:  500 / 4000 [ 12%]  (Warmup) </span>
<span class="co">#&gt; Chain 1 Iteration:  600 / 4000 [ 15%]  (Warmup) </span>
<span class="co">#&gt; Chain 1 Iteration:  700 / 4000 [ 17%]  (Warmup) </span>
<span class="co">#&gt; Chain 1 Iteration:  800 / 4000 [ 20%]  (Warmup) </span>
<span class="co">#&gt; Chain 1 Iteration:  900 / 4000 [ 22%]  (Warmup) </span>
<span class="co">#&gt; Chain 1 Iteration: 1000 / 4000 [ 25%]  (Warmup) </span>
<span class="co">#&gt; Chain 1 Iteration: 1100 / 4000 [ 27%]  (Warmup) </span>
<span class="co">#&gt; Chain 1 Iteration: 1200 / 4000 [ 30%]  (Warmup) </span>
<span class="co">#&gt; Chain 1 Iteration: 1300 / 4000 [ 32%]  (Warmup) </span>
<span class="co">#&gt; Chain 1 Iteration: 1400 / 4000 [ 35%]  (Warmup) </span>
<span class="co">#&gt; Chain 1 Iteration: 1500 / 4000 [ 37%]  (Warmup) </span>
<span class="co">#&gt; Chain 1 Iteration: 1600 / 4000 [ 40%]  (Warmup) </span>
<span class="co">#&gt; Chain 1 Iteration: 1700 / 4000 [ 42%]  (Warmup) </span>
<span class="co">#&gt; Chain 1 Iteration: 1800 / 4000 [ 45%]  (Warmup) </span>
<span class="co">#&gt; Chain 1 Iteration: 1900 / 4000 [ 47%]  (Warmup) </span>
<span class="co">#&gt; Chain 1 Iteration: 2000 / 4000 [ 50%]  (Warmup) </span>
<span class="co">#&gt; Chain 1 Iteration: 2001 / 4000 [ 50%]  (Sampling) </span>
<span class="co">#&gt; Chain 1 Iteration: 2100 / 4000 [ 52%]  (Sampling) </span>
<span class="co">#&gt; Chain 1 Iteration: 2200 / 4000 [ 55%]  (Sampling) </span>
<span class="co">#&gt; Chain 1 Iteration: 2300 / 4000 [ 57%]  (Sampling) </span>
<span class="co">#&gt; Chain 1 Iteration: 2400 / 4000 [ 60%]  (Sampling) </span>
<span class="co">#&gt; Chain 1 Iteration: 2500 / 4000 [ 62%]  (Sampling) </span>
<span class="co">#&gt; Chain 1 Iteration: 2600 / 4000 [ 65%]  (Sampling) </span>
<span class="co">#&gt; Chain 1 Iteration: 2700 / 4000 [ 67%]  (Sampling) </span>
<span class="co">#&gt; Chain 1 Iteration: 2800 / 4000 [ 70%]  (Sampling) </span>
<span class="co">#&gt; Chain 1 Iteration: 2900 / 4000 [ 72%]  (Sampling) </span>
<span class="co">#&gt; Chain 1 Iteration: 3000 / 4000 [ 75%]  (Sampling) </span>
<span class="co">#&gt; Chain 1 Iteration: 3100 / 4000 [ 77%]  (Sampling) </span>
<span class="co">#&gt; Chain 1 Iteration: 3200 / 4000 [ 80%]  (Sampling) </span>
<span class="co">#&gt; Chain 1 Iteration: 3300 / 4000 [ 82%]  (Sampling) </span>
<span class="co">#&gt; Chain 1 Iteration: 3400 / 4000 [ 85%]  (Sampling) </span>
<span class="co">#&gt; Chain 1 Iteration: 3500 / 4000 [ 87%]  (Sampling) </span>
<span class="co">#&gt; Chain 1 Iteration: 3600 / 4000 [ 90%]  (Sampling) </span>
<span class="co">#&gt; Chain 1 Iteration: 3700 / 4000 [ 92%]  (Sampling) </span>
<span class="co">#&gt; Chain 1 Iteration: 3800 / 4000 [ 95%]  (Sampling) </span>
<span class="co">#&gt; Chain 1 Iteration: 3900 / 4000 [ 97%]  (Sampling) </span>
<span class="co">#&gt; Chain 1 Iteration: 4000 / 4000 [100%]  (Sampling) </span>
<span class="co">#&gt; Chain 1 finished in 14.9 seconds.</span>
<span class="co">#&gt; Chain 2 Iteration:    1 / 4000 [  0%]  (Warmup) </span>
<span class="co">#&gt; Chain 2 Iteration:  100 / 4000 [  2%]  (Warmup) </span>
<span class="co">#&gt; Chain 2 Iteration:  200 / 4000 [  5%]  (Warmup) </span>
<span class="co">#&gt; Chain 2 Iteration:  300 / 4000 [  7%]  (Warmup) </span>
<span class="co">#&gt; Chain 2 Iteration:  400 / 4000 [ 10%]  (Warmup) </span>
<span class="co">#&gt; Chain 2 Iteration:  500 / 4000 [ 12%]  (Warmup) </span>
<span class="co">#&gt; Chain 2 Iteration:  600 / 4000 [ 15%]  (Warmup) </span>
<span class="co">#&gt; Chain 2 Iteration:  700 / 4000 [ 17%]  (Warmup) </span>
<span class="co">#&gt; Chain 2 Iteration:  800 / 4000 [ 20%]  (Warmup) </span>
<span class="co">#&gt; Chain 2 Iteration:  900 / 4000 [ 22%]  (Warmup) </span>
<span class="co">#&gt; Chain 2 Iteration: 1000 / 4000 [ 25%]  (Warmup) </span>
<span class="co">#&gt; Chain 2 Iteration: 1100 / 4000 [ 27%]  (Warmup) </span>
<span class="co">#&gt; Chain 2 Iteration: 1200 / 4000 [ 30%]  (Warmup) </span>
<span class="co">#&gt; Chain 2 Iteration: 1300 / 4000 [ 32%]  (Warmup) </span>
<span class="co">#&gt; Chain 2 Iteration: 1400 / 4000 [ 35%]  (Warmup) </span>
<span class="co">#&gt; Chain 2 Iteration: 1500 / 4000 [ 37%]  (Warmup) </span>
<span class="co">#&gt; Chain 2 Iteration: 1600 / 4000 [ 40%]  (Warmup) </span>
<span class="co">#&gt; Chain 2 Iteration: 1700 / 4000 [ 42%]  (Warmup) </span>
<span class="co">#&gt; Chain 2 Iteration: 1800 / 4000 [ 45%]  (Warmup) </span>
<span class="co">#&gt; Chain 2 Iteration: 1900 / 4000 [ 47%]  (Warmup) </span>
<span class="co">#&gt; Chain 2 Iteration: 2000 / 4000 [ 50%]  (Warmup) </span>
<span class="co">#&gt; Chain 2 Iteration: 2001 / 4000 [ 50%]  (Sampling) </span>
<span class="co">#&gt; Chain 2 Iteration: 2100 / 4000 [ 52%]  (Sampling) </span>
<span class="co">#&gt; Chain 2 Iteration: 2200 / 4000 [ 55%]  (Sampling) </span>
<span class="co">#&gt; Chain 2 Iteration: 2300 / 4000 [ 57%]  (Sampling) </span>
<span class="co">#&gt; Chain 2 Iteration: 2400 / 4000 [ 60%]  (Sampling) </span>
<span class="co">#&gt; Chain 2 Iteration: 2500 / 4000 [ 62%]  (Sampling) </span>
<span class="co">#&gt; Chain 2 Iteration: 2600 / 4000 [ 65%]  (Sampling) </span>
<span class="co">#&gt; Chain 2 Iteration: 2700 / 4000 [ 67%]  (Sampling) </span>
<span class="co">#&gt; Chain 2 Iteration: 2800 / 4000 [ 70%]  (Sampling) </span>
<span class="co">#&gt; Chain 2 Iteration: 2900 / 4000 [ 72%]  (Sampling) </span>
<span class="co">#&gt; Chain 2 Iteration: 3000 / 4000 [ 75%]  (Sampling) </span>
<span class="co">#&gt; Chain 2 Iteration: 3100 / 4000 [ 77%]  (Sampling) </span>
<span class="co">#&gt; Chain 2 Iteration: 3200 / 4000 [ 80%]  (Sampling) </span>
<span class="co">#&gt; Chain 2 Iteration: 3300 / 4000 [ 82%]  (Sampling) </span>
<span class="co">#&gt; Chain 2 Iteration: 3400 / 4000 [ 85%]  (Sampling) </span>
<span class="co">#&gt; Chain 2 Iteration: 3500 / 4000 [ 87%]  (Sampling) </span>
<span class="co">#&gt; Chain 2 Iteration: 3600 / 4000 [ 90%]  (Sampling) </span>
<span class="co">#&gt; Chain 2 Iteration: 3700 / 4000 [ 92%]  (Sampling) </span>
<span class="co">#&gt; Chain 2 Iteration: 3800 / 4000 [ 95%]  (Sampling) </span>
<span class="co">#&gt; Chain 2 Iteration: 3900 / 4000 [ 97%]  (Sampling) </span>
<span class="co">#&gt; Chain 2 Iteration: 4000 / 4000 [100%]  (Sampling) </span>
<span class="co">#&gt; Chain 2 finished in 15.7 seconds.</span>
<span class="co">#&gt; Chain 3 Iteration:    1 / 4000 [  0%]  (Warmup) </span>
<span class="co">#&gt; Chain 3 Iteration:  100 / 4000 [  2%]  (Warmup) </span>
<span class="co">#&gt; Chain 3 Iteration:  200 / 4000 [  5%]  (Warmup) </span>
<span class="co">#&gt; Chain 3 Iteration:  300 / 4000 [  7%]  (Warmup) </span>
<span class="co">#&gt; Chain 3 Iteration:  400 / 4000 [ 10%]  (Warmup) </span>
<span class="co">#&gt; Chain 3 Iteration:  500 / 4000 [ 12%]  (Warmup) </span>
<span class="co">#&gt; Chain 3 Iteration:  600 / 4000 [ 15%]  (Warmup) </span>
<span class="co">#&gt; Chain 3 Iteration:  700 / 4000 [ 17%]  (Warmup) </span>
<span class="co">#&gt; Chain 3 Iteration:  800 / 4000 [ 20%]  (Warmup) </span>
<span class="co">#&gt; Chain 3 Iteration:  900 / 4000 [ 22%]  (Warmup) </span>
<span class="co">#&gt; Chain 3 Iteration: 1000 / 4000 [ 25%]  (Warmup) </span>
<span class="co">#&gt; Chain 3 Iteration: 1100 / 4000 [ 27%]  (Warmup) </span>
<span class="co">#&gt; Chain 3 Iteration: 1200 / 4000 [ 30%]  (Warmup) </span>
<span class="co">#&gt; Chain 3 Iteration: 1300 / 4000 [ 32%]  (Warmup) </span>
<span class="co">#&gt; Chain 3 Iteration: 1400 / 4000 [ 35%]  (Warmup) </span>
<span class="co">#&gt; Chain 3 Iteration: 1500 / 4000 [ 37%]  (Warmup) </span>
<span class="co">#&gt; Chain 3 Iteration: 1600 / 4000 [ 40%]  (Warmup) </span>
<span class="co">#&gt; Chain 3 Iteration: 1700 / 4000 [ 42%]  (Warmup) </span>
<span class="co">#&gt; Chain 3 Iteration: 1800 / 4000 [ 45%]  (Warmup) </span>
<span class="co">#&gt; Chain 3 Iteration: 1900 / 4000 [ 47%]  (Warmup) </span>
<span class="co">#&gt; Chain 3 Iteration: 2000 / 4000 [ 50%]  (Warmup) </span>
<span class="co">#&gt; Chain 3 Iteration: 2001 / 4000 [ 50%]  (Sampling) </span>
<span class="co">#&gt; Chain 3 Iteration: 2100 / 4000 [ 52%]  (Sampling) </span>
<span class="co">#&gt; Chain 3 Iteration: 2200 / 4000 [ 55%]  (Sampling) </span>
<span class="co">#&gt; Chain 3 Iteration: 2300 / 4000 [ 57%]  (Sampling) </span>
<span class="co">#&gt; Chain 3 Iteration: 2400 / 4000 [ 60%]  (Sampling) </span>
<span class="co">#&gt; Chain 3 Iteration: 2500 / 4000 [ 62%]  (Sampling) </span>
<span class="co">#&gt; Chain 3 Iteration: 2600 / 4000 [ 65%]  (Sampling) </span>
<span class="co">#&gt; Chain 3 Iteration: 2700 / 4000 [ 67%]  (Sampling) </span>
<span class="co">#&gt; Chain 3 Iteration: 2800 / 4000 [ 70%]  (Sampling) </span>
<span class="co">#&gt; Chain 3 Iteration: 2900 / 4000 [ 72%]  (Sampling) </span>
<span class="co">#&gt; Chain 3 Iteration: 3000 / 4000 [ 75%]  (Sampling) </span>
<span class="co">#&gt; Chain 3 Iteration: 3100 / 4000 [ 77%]  (Sampling) </span>
<span class="co">#&gt; Chain 3 Iteration: 3200 / 4000 [ 80%]  (Sampling) </span>
<span class="co">#&gt; Chain 3 Iteration: 3300 / 4000 [ 82%]  (Sampling) </span>
<span class="co">#&gt; Chain 3 Iteration: 3400 / 4000 [ 85%]  (Sampling) </span>
<span class="co">#&gt; Chain 3 Iteration: 3500 / 4000 [ 87%]  (Sampling) </span>
<span class="co">#&gt; Chain 3 Iteration: 3600 / 4000 [ 90%]  (Sampling) </span>
<span class="co">#&gt; Chain 3 Iteration: 3700 / 4000 [ 92%]  (Sampling) </span>
<span class="co">#&gt; Chain 3 Iteration: 3800 / 4000 [ 95%]  (Sampling) </span>
<span class="co">#&gt; Chain 3 Iteration: 3900 / 4000 [ 97%]  (Sampling) </span>
<span class="co">#&gt; Chain 3 Iteration: 4000 / 4000 [100%]  (Sampling) </span>
<span class="co">#&gt; Chain 3 finished in 15.7 seconds.</span>
<span class="co">#&gt; Chain 4 Iteration:    1 / 4000 [  0%]  (Warmup) </span>
<span class="co">#&gt; Chain 4 Iteration:  100 / 4000 [  2%]  (Warmup) </span>
<span class="co">#&gt; Chain 4 Iteration:  200 / 4000 [  5%]  (Warmup) </span>
<span class="co">#&gt; Chain 4 Iteration:  300 / 4000 [  7%]  (Warmup) </span>
<span class="co">#&gt; Chain 4 Iteration:  400 / 4000 [ 10%]  (Warmup) </span>
<span class="co">#&gt; Chain 4 Iteration:  500 / 4000 [ 12%]  (Warmup) </span>
<span class="co">#&gt; Chain 4 Iteration:  600 / 4000 [ 15%]  (Warmup) </span>
<span class="co">#&gt; Chain 4 Iteration:  700 / 4000 [ 17%]  (Warmup) </span>
<span class="co">#&gt; Chain 4 Iteration:  800 / 4000 [ 20%]  (Warmup) </span>
<span class="co">#&gt; Chain 4 Iteration:  900 / 4000 [ 22%]  (Warmup) </span>
<span class="co">#&gt; Chain 4 Iteration: 1000 / 4000 [ 25%]  (Warmup) </span>
<span class="co">#&gt; Chain 4 Iteration: 1100 / 4000 [ 27%]  (Warmup) </span>
<span class="co">#&gt; Chain 4 Iteration: 1200 / 4000 [ 30%]  (Warmup) </span>
<span class="co">#&gt; Chain 4 Iteration: 1300 / 4000 [ 32%]  (Warmup) </span>
<span class="co">#&gt; Chain 4 Iteration: 1400 / 4000 [ 35%]  (Warmup) </span>
<span class="co">#&gt; Chain 4 Iteration: 1500 / 4000 [ 37%]  (Warmup) </span>
<span class="co">#&gt; Chain 4 Iteration: 1600 / 4000 [ 40%]  (Warmup) </span>
<span class="co">#&gt; Chain 4 Iteration: 1700 / 4000 [ 42%]  (Warmup) </span>
<span class="co">#&gt; Chain 4 Iteration: 1800 / 4000 [ 45%]  (Warmup) </span>
<span class="co">#&gt; Chain 4 Iteration: 1900 / 4000 [ 47%]  (Warmup) </span>
<span class="co">#&gt; Chain 4 Iteration: 2000 / 4000 [ 50%]  (Warmup) </span>
<span class="co">#&gt; Chain 4 Iteration: 2001 / 4000 [ 50%]  (Sampling) </span>
<span class="co">#&gt; Chain 4 Iteration: 2100 / 4000 [ 52%]  (Sampling) </span>
<span class="co">#&gt; Chain 4 Iteration: 2200 / 4000 [ 55%]  (Sampling) </span>
<span class="co">#&gt; Chain 4 Iteration: 2300 / 4000 [ 57%]  (Sampling) </span>
<span class="co">#&gt; Chain 4 Iteration: 2400 / 4000 [ 60%]  (Sampling) </span>
<span class="co">#&gt; Chain 4 Iteration: 2500 / 4000 [ 62%]  (Sampling) </span>
<span class="co">#&gt; Chain 4 Iteration: 2600 / 4000 [ 65%]  (Sampling) </span>
<span class="co">#&gt; Chain 4 Iteration: 2700 / 4000 [ 67%]  (Sampling) </span>
<span class="co">#&gt; Chain 4 Iteration: 2800 / 4000 [ 70%]  (Sampling) </span>
<span class="co">#&gt; Chain 4 Iteration: 2900 / 4000 [ 72%]  (Sampling) </span>
<span class="co">#&gt; Chain 4 Iteration: 3000 / 4000 [ 75%]  (Sampling) </span>
<span class="co">#&gt; Chain 4 Iteration: 3100 / 4000 [ 77%]  (Sampling) </span>
<span class="co">#&gt; Chain 4 Iteration: 3200 / 4000 [ 80%]  (Sampling) </span>
<span class="co">#&gt; Chain 4 Iteration: 3300 / 4000 [ 82%]  (Sampling) </span>
<span class="co">#&gt; Chain 4 Iteration: 3400 / 4000 [ 85%]  (Sampling) </span>
<span class="co">#&gt; Chain 4 Iteration: 3500 / 4000 [ 87%]  (Sampling) </span>
<span class="co">#&gt; Chain 4 Iteration: 3600 / 4000 [ 90%]  (Sampling) </span>
<span class="co">#&gt; Chain 4 Iteration: 3700 / 4000 [ 92%]  (Sampling) </span>
<span class="co">#&gt; Chain 4 Iteration: 3800 / 4000 [ 95%]  (Sampling) </span>
<span class="co">#&gt; Chain 4 Iteration: 3900 / 4000 [ 97%]  (Sampling) </span>
<span class="co">#&gt; Chain 4 Iteration: 4000 / 4000 [100%]  (Sampling) </span>
<span class="co">#&gt; Chain 4 finished in 16.4 seconds.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; All 4 chains finished successfully.</span>
<span class="co">#&gt; Mean chain execution time: 15.7 seconds.</span>
<span class="co">#&gt; Total execution time: 63.2 seconds.</span>
<span class="co">#&gt; 1000 vector or matrix parameters hidden. Use depth=2 to show them.</span>
<span class="co">#&gt;             mean          sd       5.5%      94.5%    n_eff     Rhat4</span>
<span class="co">#&gt; alpha 0.04905132 0.001360069 0.04697336 0.05128713 7247.988 0.9998833</span></code></pre></div>
<p>Result:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># Counts exceeding UCLs</span>
<span class="co"># *********************</span>
<span class="co"># ucl_true_theta:</span>
<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">y_new</span> <span class="op">-</span> <span class="va">d</span><span class="op">$</span><span class="va">ucl_true_theta</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span>
<span class="co">#&gt; [1] 4</span>
<span class="co"># ucl_nopool:</span>
<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">y_new</span> <span class="op">-</span> <span class="va">d</span><span class="op">$</span><span class="va">ucl_nopool</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span>
<span class="co">#&gt; [1] 68</span>
<span class="co"># ucl_complpool:</span>
<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">y_new</span> <span class="op">-</span> <span class="va">d</span><span class="op">$</span><span class="va">ucl_complpool</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span>
<span class="co">#&gt; [1] 74</span>
<span class="co"># ucl_partpool:</span>
<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">y_new</span> <span class="op">-</span> <span class="va">d</span><span class="op">$</span><span class="va">ucl_partpool</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span>
<span class="co">#&gt; [1] 18</span>

<span class="va">d</span><span class="op">[</span><span class="va">d</span><span class="op">$</span><span class="va">y_new</span> <span class="op">-</span> <span class="va">d</span><span class="op">$</span><span class="va">ucl_partpool</span> <span class="op">&gt;</span> <span class="fl">0</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"n"</span>, <span class="st">"y"</span>, <span class="st">"n_new"</span>, <span class="st">"y_new"</span>,
    <span class="st">"true_theta"</span>, <span class="st">"theta_partpool"</span>,
    <span class="st">"ucl_true_theta"</span>, <span class="st">"ucl_partpool"</span><span class="op">)</span><span class="op">]</span>
<span class="co">#&gt;        n  y n_new y_new true_theta theta_partpool ucl_true_theta ucl_partpool</span>
<span class="co">#&gt; 109   24  0    12     3 0.05812885    0.024302886            3.5          2.5</span>
<span class="co">#&gt; 228   54  1    27     4 0.11591158    0.027967910            8.5          3.5</span>
<span class="co">#&gt; 364   95  5    48     8 0.10194831    0.050417683           12.5          7.5</span>
<span class="co">#&gt; 374  100  2    50     6 0.07644745    0.026326791           10.5          5.5</span>
<span class="co">#&gt; 399  110  1    55     5 0.01644587    0.016491387            4.5          4.5</span>
<span class="co">#&gt; 462  136  2    68     8 0.04883827    0.020516222            9.5          5.5</span>
<span class="co">#&gt; 501  157  9    79    12 0.08478296    0.054769164           14.5         11.5</span>
<span class="co">#&gt; 529  171  5    86     9 0.05595134    0.032173221           11.5          8.5</span>
<span class="co">#&gt; 598  210  1   105     5 0.03900614    0.009289763           10.5          4.5</span>
<span class="co">#&gt; 613  219  2   110     6 0.01705977    0.013208173            6.5          5.5</span>
<span class="co">#&gt; 635  239 12   120    14 0.06846729    0.049739447           17.5         13.5</span>
<span class="co">#&gt; 698  289  9   145    16 0.04752106    0.032966185           15.5         11.5</span>
<span class="co">#&gt; 751  336  3   168     7 0.01771915    0.011626066            8.5          6.5</span>
<span class="co">#&gt; 805  410 39   205    33 0.15066465    0.089261026           48.5         31.5</span>
<span class="co">#&gt; 894  612 26   306    25 0.05070100    0.042676439           27.5         24.5</span>
<span class="co">#&gt; 935  802 54   401    51 0.09019851    0.066278225           54.5         42.5</span>
<span class="co">#&gt; 967 1040 26   520    25 0.03408030    0.025680542           30.5         24.5</span>
<span class="co">#&gt; 974 1124 73   562    55 0.07536090    0.064351810           62.5         54.5</span></code></pre></div>
<div id="alternatively" class="section level3">
<h3 class="hasAnchor">
<a href="#alternatively" class="anchor"></a>Alternatively:</h3>
<p>Using the dataset provided in the package, the same result (here without the true_theta values) can be obtained with:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">e</span> <span class="op">&lt;-</span> <span class="va">simdat</span>
<span class="va">d1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/countcheck.html">countcheck</a></span><span class="op">(</span>unit <span class="op">=</span> <span class="va">e</span><span class="op">$</span><span class="va">unit</span>,
                 n <span class="op">=</span> <span class="va">e</span><span class="op">$</span><span class="va">n</span>,
                 y <span class="op">=</span> <span class="va">e</span><span class="op">$</span><span class="va">y</span>,
                 n_new <span class="op">=</span> <span class="va">e</span><span class="op">$</span><span class="va">n_new</span>,
                 y_new <span class="op">=</span> <span class="va">e</span><span class="op">$</span><span class="va">y_new</span>,
                 random_seed <span class="op">=</span> <span class="fl">200807</span><span class="op">)</span>
<span class="co">#&gt; Compiling Stan program...</span>
<span class="co">#&gt; Running MCMC with 4 sequential chains, with 1 thread(s) per chain...</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Chain 1 Iteration:    1 / 4000 [  0%]  (Warmup) </span>
<span class="co">#&gt; Chain 1 Iteration:  100 / 4000 [  2%]  (Warmup) </span>
<span class="co">#&gt; Chain 1 Iteration:  200 / 4000 [  5%]  (Warmup) </span>
<span class="co">#&gt; Chain 1 Iteration:  300 / 4000 [  7%]  (Warmup) </span>
<span class="co">#&gt; Chain 1 Iteration:  400 / 4000 [ 10%]  (Warmup) </span>
<span class="co">#&gt; Chain 1 Iteration:  500 / 4000 [ 12%]  (Warmup) </span>
<span class="co">#&gt; Chain 1 Iteration:  600 / 4000 [ 15%]  (Warmup) </span>
<span class="co">#&gt; Chain 1 Iteration:  700 / 4000 [ 17%]  (Warmup) </span>
<span class="co">#&gt; Chain 1 Iteration:  800 / 4000 [ 20%]  (Warmup) </span>
<span class="co">#&gt; Chain 1 Iteration:  900 / 4000 [ 22%]  (Warmup) </span>
<span class="co">#&gt; Chain 1 Iteration: 1000 / 4000 [ 25%]  (Warmup) </span>
<span class="co">#&gt; Chain 1 Iteration: 1100 / 4000 [ 27%]  (Warmup) </span>
<span class="co">#&gt; Chain 1 Iteration: 1200 / 4000 [ 30%]  (Warmup) </span>
<span class="co">#&gt; Chain 1 Iteration: 1300 / 4000 [ 32%]  (Warmup) </span>
<span class="co">#&gt; Chain 1 Iteration: 1400 / 4000 [ 35%]  (Warmup) </span>
<span class="co">#&gt; Chain 1 Iteration: 1500 / 4000 [ 37%]  (Warmup) </span>
<span class="co">#&gt; Chain 1 Iteration: 1600 / 4000 [ 40%]  (Warmup) </span>
<span class="co">#&gt; Chain 1 Iteration: 1700 / 4000 [ 42%]  (Warmup) </span>
<span class="co">#&gt; Chain 1 Iteration: 1800 / 4000 [ 45%]  (Warmup) </span>
<span class="co">#&gt; Chain 1 Iteration: 1900 / 4000 [ 47%]  (Warmup) </span>
<span class="co">#&gt; Chain 1 Iteration: 2000 / 4000 [ 50%]  (Warmup) </span>
<span class="co">#&gt; Chain 1 Iteration: 2001 / 4000 [ 50%]  (Sampling) </span>
<span class="co">#&gt; Chain 1 Iteration: 2100 / 4000 [ 52%]  (Sampling) </span>
<span class="co">#&gt; Chain 1 Iteration: 2200 / 4000 [ 55%]  (Sampling) </span>
<span class="co">#&gt; Chain 1 Iteration: 2300 / 4000 [ 57%]  (Sampling) </span>
<span class="co">#&gt; Chain 1 Iteration: 2400 / 4000 [ 60%]  (Sampling) </span>
<span class="co">#&gt; Chain 1 Iteration: 2500 / 4000 [ 62%]  (Sampling) </span>
<span class="co">#&gt; Chain 1 Iteration: 2600 / 4000 [ 65%]  (Sampling) </span>
<span class="co">#&gt; Chain 1 Iteration: 2700 / 4000 [ 67%]  (Sampling) </span>
<span class="co">#&gt; Chain 1 Iteration: 2800 / 4000 [ 70%]  (Sampling) </span>
<span class="co">#&gt; Chain 1 Iteration: 2900 / 4000 [ 72%]  (Sampling) </span>
<span class="co">#&gt; Chain 1 Iteration: 3000 / 4000 [ 75%]  (Sampling) </span>
<span class="co">#&gt; Chain 1 Iteration: 3100 / 4000 [ 77%]  (Sampling) </span>
<span class="co">#&gt; Chain 1 Iteration: 3200 / 4000 [ 80%]  (Sampling) </span>
<span class="co">#&gt; Chain 1 Iteration: 3300 / 4000 [ 82%]  (Sampling) </span>
<span class="co">#&gt; Chain 1 Iteration: 3400 / 4000 [ 85%]  (Sampling) </span>
<span class="co">#&gt; Chain 1 Iteration: 3500 / 4000 [ 87%]  (Sampling) </span>
<span class="co">#&gt; Chain 1 Iteration: 3600 / 4000 [ 90%]  (Sampling) </span>
<span class="co">#&gt; Chain 1 Iteration: 3700 / 4000 [ 92%]  (Sampling) </span>
<span class="co">#&gt; Chain 1 Iteration: 3800 / 4000 [ 95%]  (Sampling) </span>
<span class="co">#&gt; Chain 1 Iteration: 3900 / 4000 [ 97%]  (Sampling) </span>
<span class="co">#&gt; Chain 1 Iteration: 4000 / 4000 [100%]  (Sampling) </span>
<span class="co">#&gt; Chain 1 finished in 17.0 seconds.</span>
<span class="co">#&gt; Chain 2 Iteration:    1 / 4000 [  0%]  (Warmup) </span>
<span class="co">#&gt; Chain 2 Iteration:  100 / 4000 [  2%]  (Warmup) </span>
<span class="co">#&gt; Chain 2 Iteration:  200 / 4000 [  5%]  (Warmup) </span>
<span class="co">#&gt; Chain 2 Iteration:  300 / 4000 [  7%]  (Warmup) </span>
<span class="co">#&gt; Chain 2 Iteration:  400 / 4000 [ 10%]  (Warmup) </span>
<span class="co">#&gt; Chain 2 Iteration:  500 / 4000 [ 12%]  (Warmup) </span>
<span class="co">#&gt; Chain 2 Iteration:  600 / 4000 [ 15%]  (Warmup) </span>
<span class="co">#&gt; Chain 2 Iteration:  700 / 4000 [ 17%]  (Warmup) </span>
<span class="co">#&gt; Chain 2 Iteration:  800 / 4000 [ 20%]  (Warmup) </span>
<span class="co">#&gt; Chain 2 Iteration:  900 / 4000 [ 22%]  (Warmup) </span>
<span class="co">#&gt; Chain 2 Iteration: 1000 / 4000 [ 25%]  (Warmup) </span>
<span class="co">#&gt; Chain 2 Iteration: 1100 / 4000 [ 27%]  (Warmup) </span>
<span class="co">#&gt; Chain 2 Iteration: 1200 / 4000 [ 30%]  (Warmup) </span>
<span class="co">#&gt; Chain 2 Iteration: 1300 / 4000 [ 32%]  (Warmup) </span>
<span class="co">#&gt; Chain 2 Iteration: 1400 / 4000 [ 35%]  (Warmup) </span>
<span class="co">#&gt; Chain 2 Iteration: 1500 / 4000 [ 37%]  (Warmup) </span>
<span class="co">#&gt; Chain 2 Iteration: 1600 / 4000 [ 40%]  (Warmup) </span>
<span class="co">#&gt; Chain 2 Iteration: 1700 / 4000 [ 42%]  (Warmup) </span>
<span class="co">#&gt; Chain 2 Iteration: 1800 / 4000 [ 45%]  (Warmup) </span>
<span class="co">#&gt; Chain 2 Iteration: 1900 / 4000 [ 47%]  (Warmup) </span>
<span class="co">#&gt; Chain 2 Iteration: 2000 / 4000 [ 50%]  (Warmup) </span>
<span class="co">#&gt; Chain 2 Iteration: 2001 / 4000 [ 50%]  (Sampling) </span>
<span class="co">#&gt; Chain 2 Iteration: 2100 / 4000 [ 52%]  (Sampling) </span>
<span class="co">#&gt; Chain 2 Iteration: 2200 / 4000 [ 55%]  (Sampling) </span>
<span class="co">#&gt; Chain 2 Iteration: 2300 / 4000 [ 57%]  (Sampling) </span>
<span class="co">#&gt; Chain 2 Iteration: 2400 / 4000 [ 60%]  (Sampling) </span>
<span class="co">#&gt; Chain 2 Iteration: 2500 / 4000 [ 62%]  (Sampling) </span>
<span class="co">#&gt; Chain 2 Iteration: 2600 / 4000 [ 65%]  (Sampling) </span>
<span class="co">#&gt; Chain 2 Iteration: 2700 / 4000 [ 67%]  (Sampling) </span>
<span class="co">#&gt; Chain 2 Iteration: 2800 / 4000 [ 70%]  (Sampling) </span>
<span class="co">#&gt; Chain 2 Iteration: 2900 / 4000 [ 72%]  (Sampling) </span>
<span class="co">#&gt; Chain 2 Iteration: 3000 / 4000 [ 75%]  (Sampling) </span>
<span class="co">#&gt; Chain 2 Iteration: 3100 / 4000 [ 77%]  (Sampling) </span>
<span class="co">#&gt; Chain 2 Iteration: 3200 / 4000 [ 80%]  (Sampling) </span>
<span class="co">#&gt; Chain 2 Iteration: 3300 / 4000 [ 82%]  (Sampling) </span>
<span class="co">#&gt; Chain 2 Iteration: 3400 / 4000 [ 85%]  (Sampling) </span>
<span class="co">#&gt; Chain 2 Iteration: 3500 / 4000 [ 87%]  (Sampling) </span>
<span class="co">#&gt; Chain 2 Iteration: 3600 / 4000 [ 90%]  (Sampling) </span>
<span class="co">#&gt; Chain 2 Iteration: 3700 / 4000 [ 92%]  (Sampling) </span>
<span class="co">#&gt; Chain 2 Iteration: 3800 / 4000 [ 95%]  (Sampling) </span>
<span class="co">#&gt; Chain 2 Iteration: 3900 / 4000 [ 97%]  (Sampling) </span>
<span class="co">#&gt; Chain 2 Iteration: 4000 / 4000 [100%]  (Sampling) </span>
<span class="co">#&gt; Chain 2 finished in 18.5 seconds.</span>
<span class="co">#&gt; Chain 3 Iteration:    1 / 4000 [  0%]  (Warmup) </span>
<span class="co">#&gt; Chain 3 Iteration:  100 / 4000 [  2%]  (Warmup) </span>
<span class="co">#&gt; Chain 3 Iteration:  200 / 4000 [  5%]  (Warmup) </span>
<span class="co">#&gt; Chain 3 Iteration:  300 / 4000 [  7%]  (Warmup) </span>
<span class="co">#&gt; Chain 3 Iteration:  400 / 4000 [ 10%]  (Warmup) </span>
<span class="co">#&gt; Chain 3 Iteration:  500 / 4000 [ 12%]  (Warmup) </span>
<span class="co">#&gt; Chain 3 Iteration:  600 / 4000 [ 15%]  (Warmup) </span>
<span class="co">#&gt; Chain 3 Iteration:  700 / 4000 [ 17%]  (Warmup) </span>
<span class="co">#&gt; Chain 3 Iteration:  800 / 4000 [ 20%]  (Warmup) </span>
<span class="co">#&gt; Chain 3 Iteration:  900 / 4000 [ 22%]  (Warmup) </span>
<span class="co">#&gt; Chain 3 Iteration: 1000 / 4000 [ 25%]  (Warmup) </span>
<span class="co">#&gt; Chain 3 Iteration: 1100 / 4000 [ 27%]  (Warmup) </span>
<span class="co">#&gt; Chain 3 Iteration: 1200 / 4000 [ 30%]  (Warmup) </span>
<span class="co">#&gt; Chain 3 Iteration: 1300 / 4000 [ 32%]  (Warmup) </span>
<span class="co">#&gt; Chain 3 Iteration: 1400 / 4000 [ 35%]  (Warmup) </span>
<span class="co">#&gt; Chain 3 Iteration: 1500 / 4000 [ 37%]  (Warmup) </span>
<span class="co">#&gt; Chain 3 Iteration: 1600 / 4000 [ 40%]  (Warmup) </span>
<span class="co">#&gt; Chain 3 Iteration: 1700 / 4000 [ 42%]  (Warmup) </span>
<span class="co">#&gt; Chain 3 Iteration: 1800 / 4000 [ 45%]  (Warmup) </span>
<span class="co">#&gt; Chain 3 Iteration: 1900 / 4000 [ 47%]  (Warmup) </span>
<span class="co">#&gt; Chain 3 Iteration: 2000 / 4000 [ 50%]  (Warmup) </span>
<span class="co">#&gt; Chain 3 Iteration: 2001 / 4000 [ 50%]  (Sampling) </span>
<span class="co">#&gt; Chain 3 Iteration: 2100 / 4000 [ 52%]  (Sampling) </span>
<span class="co">#&gt; Chain 3 Iteration: 2200 / 4000 [ 55%]  (Sampling) </span>
<span class="co">#&gt; Chain 3 Iteration: 2300 / 4000 [ 57%]  (Sampling) </span>
<span class="co">#&gt; Chain 3 Iteration: 2400 / 4000 [ 60%]  (Sampling) </span>
<span class="co">#&gt; Chain 3 Iteration: 2500 / 4000 [ 62%]  (Sampling) </span>
<span class="co">#&gt; Chain 3 Iteration: 2600 / 4000 [ 65%]  (Sampling) </span>
<span class="co">#&gt; Chain 3 Iteration: 2700 / 4000 [ 67%]  (Sampling) </span>
<span class="co">#&gt; Chain 3 Iteration: 2800 / 4000 [ 70%]  (Sampling) </span>
<span class="co">#&gt; Chain 3 Iteration: 2900 / 4000 [ 72%]  (Sampling) </span>
<span class="co">#&gt; Chain 3 Iteration: 3000 / 4000 [ 75%]  (Sampling) </span>
<span class="co">#&gt; Chain 3 Iteration: 3100 / 4000 [ 77%]  (Sampling) </span>
<span class="co">#&gt; Chain 3 Iteration: 3200 / 4000 [ 80%]  (Sampling) </span>
<span class="co">#&gt; Chain 3 Iteration: 3300 / 4000 [ 82%]  (Sampling) </span>
<span class="co">#&gt; Chain 3 Iteration: 3400 / 4000 [ 85%]  (Sampling) </span>
<span class="co">#&gt; Chain 3 Iteration: 3500 / 4000 [ 87%]  (Sampling) </span>
<span class="co">#&gt; Chain 3 Iteration: 3600 / 4000 [ 90%]  (Sampling) </span>
<span class="co">#&gt; Chain 3 Iteration: 3700 / 4000 [ 92%]  (Sampling) </span>
<span class="co">#&gt; Chain 3 Iteration: 3800 / 4000 [ 95%]  (Sampling) </span>
<span class="co">#&gt; Chain 3 Iteration: 3900 / 4000 [ 97%]  (Sampling) </span>
<span class="co">#&gt; Chain 3 Iteration: 4000 / 4000 [100%]  (Sampling) </span>
<span class="co">#&gt; Chain 3 finished in 17.8 seconds.</span>
<span class="co">#&gt; Chain 4 Iteration:    1 / 4000 [  0%]  (Warmup) </span>
<span class="co">#&gt; Chain 4 Iteration:  100 / 4000 [  2%]  (Warmup) </span>
<span class="co">#&gt; Chain 4 Iteration:  200 / 4000 [  5%]  (Warmup) </span>
<span class="co">#&gt; Chain 4 Iteration:  300 / 4000 [  7%]  (Warmup) </span>
<span class="co">#&gt; Chain 4 Iteration:  400 / 4000 [ 10%]  (Warmup) </span>
<span class="co">#&gt; Chain 4 Iteration:  500 / 4000 [ 12%]  (Warmup) </span>
<span class="co">#&gt; Chain 4 Iteration:  600 / 4000 [ 15%]  (Warmup) </span>
<span class="co">#&gt; Chain 4 Iteration:  700 / 4000 [ 17%]  (Warmup) </span>
<span class="co">#&gt; Chain 4 Iteration:  800 / 4000 [ 20%]  (Warmup) </span>
<span class="co">#&gt; Chain 4 Iteration:  900 / 4000 [ 22%]  (Warmup) </span>
<span class="co">#&gt; Chain 4 Iteration: 1000 / 4000 [ 25%]  (Warmup) </span>
<span class="co">#&gt; Chain 4 Iteration: 1100 / 4000 [ 27%]  (Warmup) </span>
<span class="co">#&gt; Chain 4 Iteration: 1200 / 4000 [ 30%]  (Warmup) </span>
<span class="co">#&gt; Chain 4 Iteration: 1300 / 4000 [ 32%]  (Warmup) </span>
<span class="co">#&gt; Chain 4 Iteration: 1400 / 4000 [ 35%]  (Warmup) </span>
<span class="co">#&gt; Chain 4 Iteration: 1500 / 4000 [ 37%]  (Warmup) </span>
<span class="co">#&gt; Chain 4 Iteration: 1600 / 4000 [ 40%]  (Warmup) </span>
<span class="co">#&gt; Chain 4 Iteration: 1700 / 4000 [ 42%]  (Warmup) </span>
<span class="co">#&gt; Chain 4 Iteration: 1800 / 4000 [ 45%]  (Warmup) </span>
<span class="co">#&gt; Chain 4 Iteration: 1900 / 4000 [ 47%]  (Warmup) </span>
<span class="co">#&gt; Chain 4 Iteration: 2000 / 4000 [ 50%]  (Warmup) </span>
<span class="co">#&gt; Chain 4 Iteration: 2001 / 4000 [ 50%]  (Sampling) </span>
<span class="co">#&gt; Chain 4 Iteration: 2100 / 4000 [ 52%]  (Sampling) </span>
<span class="co">#&gt; Chain 4 Iteration: 2200 / 4000 [ 55%]  (Sampling) </span>
<span class="co">#&gt; Chain 4 Iteration: 2300 / 4000 [ 57%]  (Sampling) </span>
<span class="co">#&gt; Chain 4 Iteration: 2400 / 4000 [ 60%]  (Sampling) </span>
<span class="co">#&gt; Chain 4 Iteration: 2500 / 4000 [ 62%]  (Sampling) </span>
<span class="co">#&gt; Chain 4 Iteration: 2600 / 4000 [ 65%]  (Sampling) </span>
<span class="co">#&gt; Chain 4 Iteration: 2700 / 4000 [ 67%]  (Sampling) </span>
<span class="co">#&gt; Chain 4 Iteration: 2800 / 4000 [ 70%]  (Sampling) </span>
<span class="co">#&gt; Chain 4 Iteration: 2900 / 4000 [ 72%]  (Sampling) </span>
<span class="co">#&gt; Chain 4 Iteration: 3000 / 4000 [ 75%]  (Sampling) </span>
<span class="co">#&gt; Chain 4 Iteration: 3100 / 4000 [ 77%]  (Sampling) </span>
<span class="co">#&gt; Chain 4 Iteration: 3200 / 4000 [ 80%]  (Sampling) </span>
<span class="co">#&gt; Chain 4 Iteration: 3300 / 4000 [ 82%]  (Sampling) </span>
<span class="co">#&gt; Chain 4 Iteration: 3400 / 4000 [ 85%]  (Sampling) </span>
<span class="co">#&gt; Chain 4 Iteration: 3500 / 4000 [ 87%]  (Sampling) </span>
<span class="co">#&gt; Chain 4 Iteration: 3600 / 4000 [ 90%]  (Sampling) </span>
<span class="co">#&gt; Chain 4 Iteration: 3700 / 4000 [ 92%]  (Sampling) </span>
<span class="co">#&gt; Chain 4 Iteration: 3800 / 4000 [ 95%]  (Sampling) </span>
<span class="co">#&gt; Chain 4 Iteration: 3900 / 4000 [ 97%]  (Sampling) </span>
<span class="co">#&gt; Chain 4 Iteration: 4000 / 4000 [100%]  (Sampling) </span>
<span class="co">#&gt; Chain 4 finished in 17.6 seconds.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; All 4 chains finished successfully.</span>
<span class="co">#&gt; Mean chain execution time: 17.7 seconds.</span>
<span class="co">#&gt; Total execution time: 71.2 seconds.</span>
<span class="co">#&gt; 1000 vector or matrix parameters hidden. Use depth=2 to show them.</span>
<span class="co">#&gt;             mean          sd       5.5%      94.5%    n_eff     Rhat4</span>
<span class="co">#&gt; alpha 0.04905132 0.001360069 0.04697336 0.05128713 7247.988 0.9998833</span></code></pre></div>
<p>Result:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">d1</span><span class="op">[</span><span class="va">d1</span><span class="op">$</span><span class="va">y_new</span> <span class="op">-</span> <span class="va">d1</span><span class="op">$</span><span class="va">ucl_partpool</span> <span class="op">&gt;</span> <span class="fl">0</span>,
   <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"n"</span>, <span class="st">"y"</span>, <span class="st">"n_new"</span>, <span class="st">"y_new"</span>,
     <span class="st">"true_theta"</span>, <span class="st">"theta_partpool"</span>,
     <span class="st">"ucl_true_theta"</span>, <span class="st">"ucl_partpool"</span><span class="op">)</span><span class="op">]</span>
<span class="co">#&gt;        n  y n_new y_new true_theta theta_partpool ucl_true_theta ucl_partpool</span>
<span class="co">#&gt; 109   24  0    12     3         NA    0.024302886             NA          2.5</span>
<span class="co">#&gt; 228   54  1    27     4         NA    0.027967910             NA          3.5</span>
<span class="co">#&gt; 364   95  5    48     8         NA    0.050417683             NA          7.5</span>
<span class="co">#&gt; 374  100  2    50     6         NA    0.026326791             NA          5.5</span>
<span class="co">#&gt; 399  110  1    55     5         NA    0.016491387             NA          4.5</span>
<span class="co">#&gt; 462  136  2    68     8         NA    0.020516222             NA          5.5</span>
<span class="co">#&gt; 501  157  9    79    12         NA    0.054769164             NA         11.5</span>
<span class="co">#&gt; 529  171  5    86     9         NA    0.032173221             NA          8.5</span>
<span class="co">#&gt; 598  210  1   105     5         NA    0.009289763             NA          4.5</span>
<span class="co">#&gt; 613  219  2   110     6         NA    0.013208173             NA          5.5</span>
<span class="co">#&gt; 635  239 12   120    14         NA    0.049739447             NA         13.5</span>
<span class="co">#&gt; 698  289  9   145    16         NA    0.032966185             NA         11.5</span>
<span class="co">#&gt; 751  336  3   168     7         NA    0.011626066             NA          6.5</span>
<span class="co">#&gt; 805  410 39   205    33         NA    0.089261026             NA         31.5</span>
<span class="co">#&gt; 894  612 26   306    25         NA    0.042676439             NA         24.5</span>
<span class="co">#&gt; 935  802 54   401    51         NA    0.066278225             NA         42.5</span>
<span class="co">#&gt; 967 1040 26   520    25         NA    0.025680542             NA         24.5</span>
<span class="co">#&gt; 974 1124 73   562    55         NA    0.064351810             NA         54.5</span></code></pre></div>
<p>In a realistic scenario it is not possible to assess performance by comparison with “true” values. The true values of <em>theta</em> are generally not known, and the probability distributions assumed for the Bayesian hierarchical model (the no-pooling model) may in fact be inappropriate.</p>
<p>On the other hand, in a realistic scenario it is often possible to assess performance by investigating individual cases.</p>
</div>
</div>
<div id="html-report" class="section level2">
<h2 class="hasAnchor">
<a href="#html-report" class="anchor"></a>HTML Report</h2>
<p>Select data from data frame d (example above) for the report:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">countcheck_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/select_for_report.html">select_for_report</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span></code></pre></div>
<p>Result:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">countcheck_df</span><span class="op">)</span>
<span class="co">#&gt; 'data.frame':    18 obs. of  3 variables:</span>
<span class="co">#&gt;  $ y_new       : int  8 16 51 3 4 5 5 6 6 7 ...</span>
<span class="co">#&gt;  $ ucl_partpool: num  5.5 11.5 42.5 2.5 3.5 4.5 4.5 5.5 5.5 6.5 ...</span>
<span class="co">#&gt;  $ unit        : int  462 698 935 109 228 399 598 374 613 751 ...</span></code></pre></div>
<p>We also need a data frame with unit master data. Here, we just generate some data:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">units_tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">countcheck_df</span><span class="op">$</span><span class="va">unit</span><span class="op">)</span><span class="op">)</span>
<span class="va">unit_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
  unit <span class="op">=</span> <span class="va">units_tmp</span>,
  unit_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Unit"</span>,
                    <span class="va">units_tmp</span><span class="op">)</span>,
  unit_url <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"http://domain/units/"</span>,
                    <span class="va">units_tmp</span>,
                    <span class="st">".html"</span><span class="op">)</span>,
  unit_group_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Group"</span>,
                          <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,
                              length.out <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">units_tmp</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p>Result:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">unit_df</span><span class="op">)</span>
<span class="co">#&gt; 'data.frame':    18 obs. of  4 variables:</span>
<span class="co">#&gt;  $ unit           : int  109 228 364 374 399 462 501 529 598 613 ...</span>
<span class="co">#&gt;  $ unit_name      : chr  "Unit 109" "Unit 228" "Unit 364" "Unit 374" ...</span>
<span class="co">#&gt;  $ unit_url       : chr  "http://domain/units/109.html" "http://domain/units/228.html" "http://domain/units/364.html" "http://domain/units/374.html" ...</span>
<span class="co">#&gt;  $ unit_group_name: chr  "Group 1" "Group 2" "Group 3" "Group 4" ...</span></code></pre></div>
<p>Generate report as R string:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">report</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/html_report.html">html_report</a></span><span class="op">(</span>
  countcheck_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>df <span class="op">=</span> <span class="va">countcheck_df</span>, caption <span class="op">=</span> <span class="st">"KPI 1"</span><span class="op">)</span>
  <span class="op">)</span>,
  unit_df <span class="op">=</span> <span class="va">unit_df</span>,
  title <span class="op">=</span> <span class="st">"Report"</span>,
  table_width_px <span class="op">=</span> <span class="fl">500</span>,
  column_headers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
    group <span class="op">=</span> <span class="st">"Group"</span>,
    count <span class="op">=</span> <span class="st">"Count"</span>,
    ucl <span class="op">=</span> <span class="st">"UCL"</span>,
    unit <span class="op">=</span> <span class="st">"Unit"</span>,
    name <span class="op">=</span> <span class="st">"Name"</span><span class="op">)</span>,
  charset <span class="op">=</span> <span class="st">"utf-8"</span>,
  lang <span class="op">=</span> <span class="st">"en"</span>,
  home_url <span class="op">=</span> <span class="st">"https://github.com/jmeydam/countcheck"</span>
<span class="op">)</span></code></pre></div>
<p>Save HTML report to disk:</p>
<pre><code>&gt; sink("report.html")
&gt; cat(report)
&gt; sink()</code></pre>
<p><a href="https://jmeydam.github.io/countcheck/report.html">View HTML report</a></p>
<p><br><br></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Jens Meydam.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
